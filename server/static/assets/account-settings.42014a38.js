import{c as de,p as ce,I as me,m as ve,a as pe,b as fe,e as ye,f as be,g as Ve,i as _e,j as ge,k as we,l as ke,n as xe,u as he,o as N,q as Ce,s as Pe,t as $e,v as Ae,w as Se,x as Te,y as Ue,z as De,A as Ie,B as qe,C as Be,D as e,E as Re,F as B,G as Q,H as U,J as E,K as Z,L as O,M as ee,N as Le,O as p,P as F,Q as f,R as h,S as l,T as _,U as S,W as k,X as Ne,Y as W,Z as M,_ as $,$ as T,a0 as a,a1 as P,a2 as R,a3 as L,a4 as x,a5 as C,a6 as I,a7 as te,a8 as ze,a9 as Fe,aa as Ee,ab as z,ac as Oe}from"./index.69b87e29.js";import{V as le}from"./VTable.693f6914.js";import{V as q}from"./VCheckbox.860dc908.js";import{V as We}from"./VSelect.191c713b.js";import{m as X}from"./md5.69001cbf.js";import{b as Y}from"./route-block.7577f022.js";import"./VCheckboxBtn.eae578de.js";const ae=de("v-alert-title"),Me=["success","info","warning","error"],je=ce({border:{type:[Boolean,String],validator:t=>typeof t=="boolean"||["top","end","bottom","start"].includes(t)},borderColor:String,closable:Boolean,closeIcon:{type:me,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:t=>Me.includes(t)},...ve(),...pe(),...fe(),...ye(),...be(),...Ve(),..._e(),...ge(),...we(),...ke({variant:"flat"})},"VAlert"),Ge=xe()({name:"VAlert",props:je(),emits:{"click:close":t=>!0,"update:modelValue":t=>!0},setup(t,i){let{emit:y,slots:o}=i;const d=he(t,"modelValue"),n=N(()=>{var w;if(t.icon!==!1)return t.type?(w=t.icon)!=null?w:`$${t.type}`:t.icon}),u=N(()=>{var w;return{color:(w=t.color)!=null?w:t.type,variant:t.variant}}),{themeClasses:V}=Ce(t),{colorClasses:g,colorStyles:b,variantClasses:m}=Pe(u),{densityClasses:r}=$e(t),{dimensionStyles:v}=Ae(t),{elevationClasses:s}=Se(t),{locationStyles:c}=Te(t),{positionClasses:D}=Ue(t),{roundedClasses:oe}=De(t),{textColorClasses:se,textColorStyles:ne}=Ie(qe(t,"borderColor")),{t:ue}=Be(),j=N(()=>({"aria-label":ue(t.closeLabel),onClick(w){d.value=!1,y("click:close",w)}}));return()=>{const w=!!(o.prepend||n.value),re=!!(o.title||t.title),ie=!!(o.close||t.closable);return d.value&&e(t.tag,{class:["v-alert",t.border&&{"v-alert--border":!!t.border,[`v-alert--border-${t.border===!0?"start":t.border}`]:!0},{"v-alert--prominent":t.prominent},V.value,g.value,r.value,s.value,D.value,oe.value,m.value,t.class],style:[b.value,v.value,c.value,t.style],role:"alert"},{default:()=>{var G,H,J;return[Re(!1,"v-alert"),t.border&&e("div",{key:"border",class:["v-alert__border",se.value],style:ne.value},null),w&&e("div",{key:"prepend",class:"v-alert__prepend"},[o.prepend?e(Q,{key:"prepend-defaults",disabled:!n.value,defaults:{VIcon:{density:t.density,icon:n.value,size:t.prominent?44:28}}},o.prepend):e(B,{key:"prepend-icon",density:t.density,icon:n.value,size:t.prominent?44:28},null)]),e("div",{class:"v-alert__content"},[re&&e(ae,{key:"title"},{default:()=>{var A,K;return[(K=(A=o.title)==null?void 0:A.call(o))!=null?K:t.title]}}),(H=(G=o.text)==null?void 0:G.call(o))!=null?H:t.text,(J=o.default)==null?void 0:J.call(o)]),o.append&&e("div",{key:"append",class:"v-alert__append"},[o.append()]),ie&&e("div",{key:"close",class:"v-alert__close"},[o.close?e(Q,{key:"close-defaults",defaults:{VBtn:{icon:t.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var A;return[(A=o.close)==null?void 0:A.call(o,{props:j.value})]}}):e(U,E({key:"close-btn",icon:t.closeIcon,size:"x-small",variant:"text"},j.value),null)])]}})}}}),He=a("thead",null,[a("tr",null,[a("th",{scope:"col"}," \u7F13\u5B58\u5730\u5740 "),a("th",{scope:"col"}," \u7528\u6237 "),a("th",{scope:"col"}," \u7FA4 "),a("th",{scope:"col"}," \u65F6\u95F4 ")])],-1),Je=a("p",{class:"mb-0"}," \u8D26\u6237\u5220\u9664\u540E\u5C06\u4E22\u5931\u6240\u6709\u8D26\u6237\u76F8\u5173\u914D\u7F6E\uFF0C\u8BF7\u786E\u8BA4 ",-1),Ke={__name:"AccountSettingsAccount",setup(t){const i=Z();O();const y=ee(),o={avatarImg:i.getters.user?`https://q1.qlogo.cn/g?b=qq&s=0&nk=${i.getters.user}`:Le,qq:i.getters.user,permissions:i.getters.permissions},d=p(structuredClone(o)),n=p(!1),u=[r=>!!r||"\u8BF7\u5148\u786E\u8BA4\u5220\u9664\u8D26\u6237"],V=p([]),g=r=>{switch(r){case"bing":return{icon:"bxl:bing",color:"primary"};case"api":return{icon:"ri:openai-fill",color:"success"};case"api3":return{icon:"ri:openai-fill",color:"success"};case"xh":return{icon:"solar:fire-bold",color:"error"};default:return{icon:"fluent:chat-12-filled",color:""}}},b=p({title:"",color:"warning",icon:"mdi-alert-circle-outline",text:""});F.post(`${i.getters.serverApi}userData`,{token:i.getters.userToken}).then(r=>{r.data&&(V.value=r.data.chat)}).catch(r=>{console.log(r)});const m=()=>{b.value.title="",b.value.text="",F.post(`${i.getters.serverApi}deleteUser`,{token:i.getters.userToken}).then(r=>{var v;(v=r.data)!=null&&v.state?(i.dispatch("user/logout"),y.push({path:"/login"})):(b.value.title="\u5220\u9664\u5931\u8D25",b.value.text=r.data.error)}).catch(r=>{b.value.title="\u5220\u9664\u5931\u8D25",b.value.text=r.message,console.log(r)})};return(r,v)=>(f(),h($,null,{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(S,{title:"\u7528\u6237\u8D44\u6599"},{default:l(()=>[e(k,{class:"d-flex"},{default:l(()=>[e(Ne,{rounded:"lg",size:"100",class:"me-6",image:d.value.avatarImg},null,8,["image"])]),_:1}),e(W),e(k,null,{default:l(()=>[e(M,{class:"mt-6"},{default:l(()=>[e($,null,{default:l(()=>[e(_,{md:"6",cols:"12"},{default:l(()=>[e(T,{readonly:"",modelValue:d.value.qq,"onUpdate:modelValue":v[0]||(v[0]=s=>d.value.qq=s),label:"\u8D26\u53F7"},null,8,["modelValue"])]),_:1}),e(_,{md:"6",cols:"12"},{default:l(()=>[e(T,{readonly:"",modelValue:d.value.permissions,"onUpdate:modelValue":v[1]||(v[1]=s=>d.value.permissions=s),label:"\u6743\u9650"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),r.$store.getters.permissions!="admin"?(f(),h(_,{key:0,cols:"12"},{default:l(()=>[e(S,{title:"\u7F13\u5B58\u9875\u9762\u4FE1\u606F"},{default:l(()=>[e(le,{class:"text-no-wrap",height:"250","fixed-header":""},{default:l(()=>[He,a("tbody",null,[(f(!0),P(R,null,L(V.value,s=>(f(),P("tr",{key:s.herf},[a("td",null,[e(B,{start:"",icon:g(s.model).icon,color:g(s.model).color},null,8,["icon","color"]),x(" "+C(s.herf),1)]),a("td",null,C(s.user),1),a("td",null,C(s.group),1),a("td",null,C(s.time),1)]))),128))])]),_:1})]),_:1})]),_:1})):I("",!0),r.$store.getters.permissions!="admin"?(f(),h(_,{key:1,cols:"12"},{default:l(()=>[b.value.title?(f(),h(te,E({key:0,class:"auth-card mb-2 app-bar-noregion"},b.value),null,16)):I("",!0),e(S,{title:"\u7528\u6237\u5220\u9664"},{default:l(()=>[e(k,null,{default:l(()=>[e(Ge,{color:"warning",variant:"tonal",class:"mb-4"},{default:l(()=>[e(ae,{class:"mb-1"},{default:l(()=>[x(" \u4F60\u786E\u5B9A\u8981\u5220\u9664\u4F60\u7684\u5E10\u6237\u5417\uFF1F ")]),_:1}),Je]),_:1}),a("div",null,[e(q,{modelValue:n.value,"onUpdate:modelValue":v[2]||(v[2]=s=>n.value=s),rules:u,label:"\u6211\u786E\u8BA4\u5220\u9664\u8D26\u6237"},null,8,["modelValue"])]),e(U,{disabled:!n.value||r.$store.getters.permissions==="admin",onClick:m,color:"error",class:"mt-3"},{default:l(()=>[x(" \u5220\u9664\u8D26\u6237 ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})):I("",!0)]),_:1}))}},Qe=a("a",{href:"javascript:void(0)"},"Request Permission",-1),Xe=a("thead",null,[a("tr",null,[a("th",{scope:"col"}," Type "),a("th",{scope:"col"}," EMAIL "),a("th",{scope:"col"}," BROWSER "),a("th",{scope:"col"}," App ")])],-1),Ye=a("p",{class:"text-base font-weight-medium"}," When should we send you notifications? ",-1),Ze={class:"d-flex flex-wrap gap-4 mt-4"},et={__name:"AccountSettingsNotification",setup(t){const i=p([{type:"New for you",email:!0,browser:!0,app:!0},{type:"Account activity",email:!0,browser:!0,app:!0},{type:"A new browser used to sign in",email:!0,browser:!0,app:!1},{type:"A new device is linked",email:!0,browser:!1,app:!1}]),y=p("Only when I'm online");return(o,d)=>(f(),h(S,{title:"Recent Devices"},{default:l(()=>[e(k,null,{default:l(()=>[x(" We need permission from your browser to show notifications. "),Qe]),_:1}),e(le,{class:"text-no-wrap"},{default:l(()=>[Xe,a("tbody",null,[(f(!0),P(R,null,L(i.value,n=>(f(),P("tr",{key:n.type},[a("td",null,C(n.type),1),a("td",null,[e(q,{modelValue:n.email,"onUpdate:modelValue":u=>n.email=u},null,8,["modelValue","onUpdate:modelValue"])]),a("td",null,[e(q,{modelValue:n.browser,"onUpdate:modelValue":u=>n.browser=u},null,8,["modelValue","onUpdate:modelValue"])]),a("td",null,[e(q,{modelValue:n.app,"onUpdate:modelValue":u=>n.app=u},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1}),e(W),e(k,null,{default:l(()=>[e(M,{onSubmit:d[1]||(d[1]=ze(()=>{},["prevent"]))},{default:l(()=>[Ye,e($,null,{default:l(()=>[e(_,{cols:"12",sm:"6"},{default:l(()=>[e(We,{modelValue:y.value,"onUpdate:modelValue":d[0]||(d[0]=n=>y.value=n),mandatory:"",items:["Only when I'm online","Anytime"]},null,8,["modelValue"])]),_:1})]),_:1}),a("div",Ze,[e(U,{type:"submit"},{default:l(()=>[x(" Save Changes ")]),_:1}),e(U,{color:"secondary",variant:"tonal",type:"reset"},{default:l(()=>[x(" Reset ")]),_:1})])]),_:1})]),_:1})]),_:1}))}},tt=a("p",{class:"text-base font-weight-medium mt-2"}," \u5BC6\u7801\u8981\u6C42\uFF1A ",-1),lt={class:"d-flex flex-column gap-y-3"},at={class:"font-weight-medium"},ot={__name:"AccountSettingsSecurity",setup(t){const i=Z();O();const y=ee(),o=p(!1),d=p(!1),n=p(!1),u=p(""),V=p(""),g=p(""),b=["\u6700\u5C118\u4E2A\u5B57\u7B26\u957F-\u8D8A\u591A\u8D8A\u597D","\u81F3\u5C11\u6709\u4E00\u4E2A\u5C0F\u5199\u5B57\u6BCD","\u81F3\u5C11\u6709\u4E00\u4E2A\u6570\u5B57\u3001\u7B26\u53F7\u6216\u7A7A\u767D\u5B57\u7B26"],m=p({title:"",color:"warning",icon:"mdi-alert-circle-outline",text:""}),r=()=>{if(m.value.title="",m.value.text="",!u.value||!V.value||!g.value){m.value.title="\u4FEE\u6539\u5931\u8D25",m.value.text="\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A";return}if(V.value!=g.value){m.value.title="\u4FEE\u6539\u5931\u8D25",m.value.text="\u4E24\u6B21\u5BC6\u7801\u4E0D\u4E00\u81F4";return}const v=X(u.value),s=X(V.value);F.post(`${i.getters.serverApi}changePassword`,{passwd:v,newPasswd:s,token:i.getters.userToken}).then(c=>{var D;(D=c.data)!=null&&D.state?(i.dispatch("user/logout"),y.push({path:"/login"})):(m.value.title="\u4FEE\u6539\u5931\u8D25",m.value.text=c.data.error)}).catch(c=>{m.value.title="\u4FEE\u6539\u5931\u8D25",m.value.text=c.message,console.log(c)})};return(v,s)=>(f(),h($,null,{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[m.value.title?(f(),h(te,E({key:0,class:"auth-card mb-2 app-bar-noregion"},m.value),null,16)):I("",!0),e(S,{title:"\u4FEE\u6539\u5BC6\u7801"},{default:l(()=>[e(M,null,{default:l(()=>[e(k,null,{default:l(()=>[e($,{class:"mb-3"},{default:l(()=>[e(_,{cols:"12",md:"6"},{default:l(()=>[e(T,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=c=>u.value=c),type:o.value?"text":"password","append-inner-icon":o.value?"mdi-eye-off-outline":"mdi-eye-outline",label:"\u65E7\u5BC6\u7801","onClick:appendInner":s[1]||(s[1]=c=>o.value=!o.value)},null,8,["modelValue","type","append-inner-icon"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(_,{cols:"12",md:"6"},{default:l(()=>[e(T,{modelValue:V.value,"onUpdate:modelValue":s[2]||(s[2]=c=>V.value=c),type:d.value?"text":"password","append-inner-icon":d.value?"mdi-eye-off-outline":"mdi-eye-outline",label:"\u65B0\u5BC6\u7801","onClick:appendInner":s[3]||(s[3]=c=>d.value=!d.value)},null,8,["modelValue","type","append-inner-icon"])]),_:1}),e(_,{cols:"12",md:"6"},{default:l(()=>[e(T,{modelValue:g.value,"onUpdate:modelValue":s[4]||(s[4]=c=>g.value=c),type:n.value?"text":"password","append-inner-icon":n.value?"mdi-eye-off-outline":"mdi-eye-outline",label:"\u91CD\u590D\u65B0\u5BC6\u7801","onClick:appendInner":s[5]||(s[5]=c=>n.value=!n.value)},null,8,["modelValue","type","append-inner-icon"])]),_:1})]),_:1})]),_:1}),e(k,null,{default:l(()=>[tt,a("ul",lt,[(f(),P(R,null,L(b,c=>a("li",{key:c,class:"d-flex"},[a("div",null,[e(B,{size:"7",icon:"mdi-circle",class:"me-3"})]),a("span",at,C(c),1)])),64))])]),_:1}),e(k,{class:"d-flex flex-wrap gap-4"},{default:l(()=>[e(U,{onClick:r},{default:l(()=>[x("\u4FEE\u6539")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}},st={__name:"account-settings",setup(t){const i=O(),y=p(i.params.tab),o=[{title:"\u8D26\u53F7\u4FE1\u606F",icon:"mdi-account-outline",tab:"account"},{title:"\u5B89\u5168",icon:"mdi-lock-open-outline",tab:"security"},{title:"\u4E2A\u4EBA\u8BBE\u7F6E",icon:"mdi-bell-outline",tab:"notification",disabled:!0}];return(d,n)=>(f(),P("div",null,[e(Ee,{modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=u=>y.value=u),"show-arrows":""},{default:l(()=>[(f(),P(R,null,L(o,u=>e(Fe,{key:u.icon,value:u.tab,disabled:u.disabled||!1},{default:l(()=>[e(B,{size:"20",start:"",icon:u.icon},null,8,["icon"]),x(" "+C(u.title),1)]),_:2},1032,["value","disabled"])),64))]),_:1},8,["modelValue"]),e(W),e(Oe,{modelValue:y.value,"onUpdate:modelValue":n[1]||(n[1]=u=>y.value=u),class:"mt-5 disable-tab-transition",touch:!1},{default:l(()=>[e(z,{value:"account"},{default:l(()=>[e(Ke)]),_:1}),e(z,{value:"security"},{default:l(()=>[e(ot)]),_:1}),e(z,{value:"notification"},{default:l(()=>[e(et)]),_:1})]),_:1},8,["modelValue"])]))}};typeof Y=="function"&&Y(st);export{st as default};
